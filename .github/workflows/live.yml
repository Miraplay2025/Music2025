name: Processar Live Config

on:
  push:
    branches:
      - main
    paths:
      - data/live.yml

jobs:
  process_live_config:
    runs-on: ubuntu-latest

    steps:
      - name: Baixar cÃ³digo do repositÃ³rio
        uses: actions/checkout@v3

      - name: Instalar yq (parser YAML)
        run: |
          sudo apt-get update
          sudo apt-get install -y yq

      - name: Ler arquivo live.yml e mostrar conteÃºdo completo
        id: ler_yaml
        run: |
          echo "ðŸ“„ ConteÃºdo do live.yml:"
          cat data/live.yml

      - name: Extrair e decodificar rclone_conf
        run: |
          RCLONE_B64=$(yq e '.rclone_conf' data/live.yml)
          echo "ðŸ”‘ ConteÃºdo base64 extraÃ­do do campo rclone_conf:"
          echo "$RCLONE_B64"
          echo
          echo "ðŸ“„ ConteÃºdo do rclone.conf decodificado:"
          echo "$RCLONE_B64" | base64 --decode || echo "Falha ao decodificar"
